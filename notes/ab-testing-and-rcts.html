<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>24 A/B testing and RCTs | Telling Stories with Data</title>
  <meta name="description" content="24 A/B testing and RCTs | Telling Stories with Data" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="24 A/B testing and RCTs | Telling Stories with Data" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="24 A/B testing and RCTs | Telling Stories with Data" />
  
  
  

<meta name="author" content="Rohan Alexander" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="case-study-airbnb-listing-in-toronto.html"/>
<link rel="next" href="matching-difference-in-differences.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i><b>1</b> Overview</a><ul>
<li class="chapter" data-level="1.1" data-path="overview.html"><a href="overview.html#on-telling-stories"><i class="fa fa-check"></i><b>1.1</b> On telling stories</a></li>
<li class="chapter" data-level="1.2" data-path="overview.html"><a href="overview.html#telling-stories-with-data"><i class="fa fa-check"></i><b>1.2</b> Telling stories with data</a></li>
<li class="chapter" data-level="1.3" data-path="overview.html"><a href="overview.html#these-notes"><i class="fa fa-check"></i><b>1.3</b> These notes</a><ul>
<li class="chapter" data-level="1.3.1" data-path="overview.html"><a href="overview.html#software"><i class="fa fa-check"></i><b>1.3.1</b> Software</a></li>
<li class="chapter" data-level="1.3.2" data-path="overview.html"><a href="overview.html#assumed-background"><i class="fa fa-check"></i><b>1.3.2</b> Assumed background</a></li>
<li class="chapter" data-level="1.3.3" data-path="overview.html"><a href="overview.html#structure"><i class="fa fa-check"></i><b>1.3.3</b> Structure</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="overview.html"><a href="overview.html#acknowledgements"><i class="fa fa-check"></i><b>1.4</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.5" data-path="overview.html"><a href="overview.html#contact"><i class="fa fa-check"></i><b>1.5</b> Contact</a></li>
<li class="chapter" data-level="1.6" data-path="overview.html"><a href="overview.html#todos"><i class="fa fa-check"></i><b>1.6</b> TODOs</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lab-getting-started.html"><a href="lab-getting-started.html"><i class="fa fa-check"></i><b>2</b> Lab - Getting started</a><ul>
<li class="chapter" data-level="2.1" data-path="lab-getting-started.html"><a href="lab-getting-started.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="lab-getting-started.html"><a href="lab-getting-started.html#tidyverse"><i class="fa fa-check"></i><b>2.2</b> Tidyverse</a><ul>
<li class="chapter" data-level="2.2.1" data-path="lab-getting-started.html"><a href="lab-getting-started.html#the-pipe"><i class="fa fa-check"></i><b>2.2.1</b> The pipe</a></li>
<li class="chapter" data-level="2.2.2" data-path="lab-getting-started.html"><a href="lab-getting-started.html#select"><i class="fa fa-check"></i><b>2.2.2</b> Select</a></li>
<li class="chapter" data-level="2.2.3" data-path="lab-getting-started.html"><a href="lab-getting-started.html#filter"><i class="fa fa-check"></i><b>2.2.3</b> Filter</a></li>
<li class="chapter" data-level="2.2.4" data-path="lab-getting-started.html"><a href="lab-getting-started.html#arrange"><i class="fa fa-check"></i><b>2.2.4</b> Arrange</a></li>
<li class="chapter" data-level="2.2.5" data-path="lab-getting-started.html"><a href="lab-getting-started.html#group_by"><i class="fa fa-check"></i><b>2.2.5</b> group_by</a></li>
<li class="chapter" data-level="2.2.6" data-path="lab-getting-started.html"><a href="lab-getting-started.html#mutate"><i class="fa fa-check"></i><b>2.2.6</b> Mutate</a></li>
<li class="chapter" data-level="2.2.7" data-path="lab-getting-started.html"><a href="lab-getting-started.html#summarise"><i class="fa fa-check"></i><b>2.2.7</b> Summarise</a></li>
<li class="chapter" data-level="2.2.8" data-path="lab-getting-started.html"><a href="lab-getting-started.html#counting-by-group"><i class="fa fa-check"></i><b>2.2.8</b> Counting by group</a></li>
<li class="chapter" data-level="2.2.9" data-path="lab-getting-started.html"><a href="lab-getting-started.html#calculate-proportions"><i class="fa fa-check"></i><b>2.2.9</b> Calculate proportions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="lab-getting-started.html"><a href="lab-getting-started.html#ggplot"><i class="fa fa-check"></i><b>2.3</b> ggplot</a><ul>
<li class="chapter" data-level="2.3.1" data-path="lab-getting-started.html"><a href="lab-getting-started.html#main-features"><i class="fa fa-check"></i><b>2.3.1</b> Main features</a></li>
<li class="chapter" data-level="2.3.2" data-path="lab-getting-started.html"><a href="lab-getting-started.html#facets"><i class="fa fa-check"></i><b>2.3.2</b> Facets</a></li>
<li class="chapter" data-level="2.3.3" data-path="lab-getting-started.html"><a href="lab-getting-started.html#small-things"><i class="fa fa-check"></i><b>2.3.3</b> Small things</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="lab-getting-started.html"><a href="lab-getting-started.html#other"><i class="fa fa-check"></i><b>2.4</b> Other</a><ul>
<li class="chapter" data-level="2.4.1" data-path="lab-getting-started.html"><a href="lab-getting-started.html#case_when"><i class="fa fa-check"></i><b>2.4.1</b> case_when</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="case-study-the-2019-canadian-federal-election.html"><a href="case-study-the-2019-canadian-federal-election.html"><i class="fa fa-check"></i><b>3</b> Case study - The 2019 Canadian Federal Election</a><ul>
<li class="chapter" data-level="3.1" data-path="case-study-the-2019-canadian-federal-election.html"><a href="case-study-the-2019-canadian-federal-election.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="case-study-the-2019-canadian-federal-election.html"><a href="case-study-the-2019-canadian-federal-election.html#create-a-graph-based-on-the-2019-canadian-federal-election"><i class="fa fa-check"></i><b>3.2</b> Create a graph based on the 2019 Canadian Federal election</a><ul>
<li class="chapter" data-level="3.2.1" data-path="case-study-the-2019-canadian-federal-election.html"><a href="case-study-the-2019-canadian-federal-election.html#getting-started"><i class="fa fa-check"></i><b>3.2.1</b> Getting started</a></li>
<li class="chapter" data-level="3.2.2" data-path="case-study-the-2019-canadian-federal-election.html"><a href="case-study-the-2019-canadian-federal-election.html#reading-in-the-data"><i class="fa fa-check"></i><b>3.2.2</b> Reading in the data</a></li>
<li class="chapter" data-level="3.2.3" data-path="case-study-the-2019-canadian-federal-election.html"><a href="case-study-the-2019-canadian-federal-election.html#clean-the-data"><i class="fa fa-check"></i><b>3.2.3</b> Clean the data</a></li>
<li class="chapter" data-level="3.2.4" data-path="case-study-the-2019-canadian-federal-election.html"><a href="case-study-the-2019-canadian-federal-election.html#make-a-graph"><i class="fa fa-check"></i><b>3.2.4</b> Make a graph</a></li>
<li class="chapter" data-level="3.2.5" data-path="case-study-the-2019-canadian-federal-election.html"><a href="case-study-the-2019-canadian-federal-election.html#make-a-table"><i class="fa fa-check"></i><b>3.2.5</b> Make a table</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="communication.html"><a href="communication.html"><i class="fa fa-check"></i><b>4</b> Communication</a><ul>
<li class="chapter" data-level="4.1" data-path="communication.html"><a href="communication.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="communication.html"><a href="communication.html#title-abstract-and-introduction"><i class="fa fa-check"></i><b>4.2</b> Title, abstract, and introduction</a></li>
<li class="chapter" data-level="4.3" data-path="communication.html"><a href="communication.html#figures-tables-equations-and-technical-terms"><i class="fa fa-check"></i><b>4.3</b> Figures, tables, equations, and technical terms</a></li>
<li class="chapter" data-level="4.4" data-path="communication.html"><a href="communication.html#on-brevity"><i class="fa fa-check"></i><b>4.4</b> On brevity</a></li>
<li class="chapter" data-level="4.5" data-path="communication.html"><a href="communication.html#other-1"><i class="fa fa-check"></i><b>4.5</b> Other</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lab-using-r-in-practice.html"><a href="lab-using-r-in-practice.html"><i class="fa fa-check"></i><b>5</b> Lab - Using R in practice</a><ul>
<li class="chapter" data-level="5.1" data-path="lab-using-r-in-practice.html"><a href="lab-using-r-in-practice.html#introduction-3"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="lab-using-r-in-practice.html"><a href="lab-using-r-in-practice.html#getting-help"><i class="fa fa-check"></i><b>5.2</b> Getting help</a></li>
<li class="chapter" data-level="5.3" data-path="lab-using-r-in-practice.html"><a href="lab-using-r-in-practice.html#mentality"><i class="fa fa-check"></i><b>5.3</b> Mentality</a></li>
<li class="chapter" data-level="5.4" data-path="lab-using-r-in-practice.html"><a href="lab-using-r-in-practice.html#style"><i class="fa fa-check"></i><b>5.4</b> Style</a></li>
<li class="chapter" data-level="5.5" data-path="lab-using-r-in-practice.html"><a href="lab-using-r-in-practice.html#learning-more"><i class="fa fa-check"></i><b>5.5</b> Learning more</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ethics.html"><a href="ethics.html"><i class="fa fa-check"></i><b>6</b> Ethics</a><ul>
<li class="chapter" data-level="6.1" data-path="ethics.html"><a href="ethics.html#introduction-4"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="ethics.html"><a href="ethics.html#questiontask"><i class="fa fa-check"></i><b>6.2</b> Question/task</a></li>
<li class="chapter" data-level="6.3" data-path="ethics.html"><a href="ethics.html#data"><i class="fa fa-check"></i><b>6.3</b> Data</a></li>
<li class="chapter" data-level="6.4" data-path="ethics.html"><a href="ethics.html#model"><i class="fa fa-check"></i><b>6.4</b> Model</a></li>
<li class="chapter" data-level="6.5" data-path="ethics.html"><a href="ethics.html#team"><i class="fa fa-check"></i><b>6.5</b> Team</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="reproducibility.html"><a href="reproducibility.html"><i class="fa fa-check"></i><b>7</b> Reproducibility</a><ul>
<li class="chapter" data-level="7.1" data-path="reproducibility.html"><a href="reproducibility.html#introduction-5"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="reproducibility.html"><a href="reproducibility.html#data-access"><i class="fa fa-check"></i><b>7.2</b> Data access</a></li>
<li class="chapter" data-level="7.3" data-path="reproducibility.html"><a href="reproducibility.html#on-mistakes"><i class="fa fa-check"></i><b>7.3</b> On mistakes</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="lab-r-markdown-and-r-projects.html"><a href="lab-r-markdown-and-r-projects.html"><i class="fa fa-check"></i><b>8</b> Lab - R Markdown and R Projects</a><ul>
<li class="chapter" data-level="8.1" data-path="lab-r-markdown-and-r-projects.html"><a href="lab-r-markdown-and-r-projects.html#r-markdown"><i class="fa fa-check"></i><b>8.1</b> R Markdown</a><ul>
<li class="chapter" data-level="8.1.1" data-path="lab-r-markdown-and-r-projects.html"><a href="lab-r-markdown-and-r-projects.html#getting-started-1"><i class="fa fa-check"></i><b>8.1.1</b> Getting started</a></li>
<li class="chapter" data-level="8.1.2" data-path="lab-r-markdown-and-r-projects.html"><a href="lab-r-markdown-and-r-projects.html#basic-commands"><i class="fa fa-check"></i><b>8.1.2</b> Basic commands</a></li>
<li class="chapter" data-level="8.1.3" data-path="lab-r-markdown-and-r-projects.html"><a href="lab-r-markdown-and-r-projects.html#r-chunks"><i class="fa fa-check"></i><b>8.1.3</b> R chunks</a></li>
<li class="chapter" data-level="8.1.4" data-path="lab-r-markdown-and-r-projects.html"><a href="lab-r-markdown-and-r-projects.html#abstracts-and-pdf-outputs"><i class="fa fa-check"></i><b>8.1.4</b> Abstracts and PDF outputs</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="lab-r-markdown-and-r-projects.html"><a href="lab-r-markdown-and-r-projects.html#r-projects"><i class="fa fa-check"></i><b>8.2</b> R projects</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="lab-git-and-docker.html"><a href="lab-git-and-docker.html"><i class="fa fa-check"></i><b>9</b> Lab - Git and Docker</a></li>
<li class="chapter" data-level="10" data-path="case-study-ttc-subway-delays.html"><a href="case-study-ttc-subway-delays.html"><i class="fa fa-check"></i><b>10</b> Case study - TTC Subway Delays</a><ul>
<li class="chapter" data-level="10.1" data-path="case-study-ttc-subway-delays.html"><a href="case-study-ttc-subway-delays.html#introduction-6"><i class="fa fa-check"></i><b>10.1</b> Introduction</a><ul>
<li class="chapter" data-level="10.1.1" data-path="case-study-ttc-subway-delays.html"><a href="case-study-ttc-subway-delays.html#prerequesites"><i class="fa fa-check"></i><b>10.1.1</b> Prerequesites</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="case-study-ttc-subway-delays.html"><a href="case-study-ttc-subway-delays.html#finding-and-downloading-data-using-opendatatoronto"><i class="fa fa-check"></i><b>10.2</b> Finding and downloading data using <code>opendatatoronto</code></a><ul>
<li class="chapter" data-level="10.2.1" data-path="case-study-ttc-subway-delays.html"><a href="case-study-ttc-subway-delays.html#finding-the-data"><i class="fa fa-check"></i><b>10.2.1</b> Finding the data</a></li>
<li class="chapter" data-level="10.2.2" data-path="case-study-ttc-subway-delays.html"><a href="case-study-ttc-subway-delays.html#retrieving-the-data"><i class="fa fa-check"></i><b>10.2.2</b> Retrieving the data</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="case-study-ttc-subway-delays.html"><a href="case-study-ttc-subway-delays.html#plotting"><i class="fa fa-check"></i><b>10.3</b> Plotting</a><ul>
<li class="chapter" data-level="10.3.1" data-path="case-study-ttc-subway-delays.html"><a href="case-study-ttc-subway-delays.html#example-1-delays-by-line"><i class="fa fa-check"></i><b>10.3.1</b> Example 1: Delays by line</a></li>
<li class="chapter" data-level="10.3.2" data-path="case-study-ttc-subway-delays.html"><a href="case-study-ttc-subway-delays.html#example-2-delays-by-time-of-day"><i class="fa fa-check"></i><b>10.3.2</b> Example 2: Delays by time of day</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="problem-set-1.html"><a href="problem-set-1.html"><i class="fa fa-check"></i><b>11</b> Problem Set 1</a></li>
<li class="chapter" data-level="12" data-path="developing-research-questions.html"><a href="developing-research-questions.html"><i class="fa fa-check"></i><b>12</b> Developing research questions</a><ul>
<li class="chapter" data-level="12.1" data-path="developing-research-questions.html"><a href="developing-research-questions.html#developing-research-questions-1"><i class="fa fa-check"></i><b>12.1</b> Developing research questions</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="gathering-data.html"><a href="gathering-data.html"><i class="fa fa-check"></i><b>13</b> Gathering data</a><ul>
<li class="chapter" data-level="13.1" data-path="gathering-data.html"><a href="gathering-data.html#gathering-data-1"><i class="fa fa-check"></i><b>13.1</b> Gathering data</a><ul>
<li class="chapter" data-level="13.1.1" data-path="gathering-data.html"><a href="gathering-data.html#deliberately-available"><i class="fa fa-check"></i><b>13.1.1</b> Deliberately available</a></li>
<li class="chapter" data-level="13.1.2" data-path="gathering-data.html"><a href="gathering-data.html#by-product"><i class="fa fa-check"></i><b>13.1.2</b> By product</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="lab-the-tidyverse.html"><a href="lab-the-tidyverse.html"><i class="fa fa-check"></i><b>14</b> Lab - The Tidyverse</a></li>
<li class="chapter" data-level="15" data-path="case-study-gathering-and-tidying-data-from-paspaley.html"><a href="case-study-gathering-and-tidying-data-from-paspaley.html"><i class="fa fa-check"></i><b>15</b> Case study - Gathering and tidying data from Paspaley</a><ul>
<li class="chapter" data-level="15.1" data-path="case-study-gathering-and-tidying-data-from-paspaley.html"><a href="case-study-gathering-and-tidying-data-from-paspaley.html#introduction-7"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="case-study-gathering-and-tidying-data-from-paspaley.html"><a href="case-study-gathering-and-tidying-data-from-paspaley.html#data-acquisition"><i class="fa fa-check"></i><b>15.2</b> Data acquisition</a></li>
<li class="chapter" data-level="15.3" data-path="case-study-gathering-and-tidying-data-from-paspaley.html"><a href="case-study-gathering-and-tidying-data-from-paspaley.html#data-cleaning"><i class="fa fa-check"></i><b>15.3</b> Data cleaning</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="case-study-rohans-books.html"><a href="case-study-rohans-books.html"><i class="fa fa-check"></i><b>16</b> Case study - Rohan’s books</a><ul>
<li class="chapter" data-level="16.1" data-path="case-study-rohans-books.html"><a href="case-study-rohans-books.html#introduction-8"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="case-study-rohans-books.html"><a href="case-study-rohans-books.html#gather-data"><i class="fa fa-check"></i><b>16.2</b> Gather data</a></li>
<li class="chapter" data-level="16.3" data-path="case-study-rohans-books.html"><a href="case-study-rohans-books.html#data-parsing-and-cleaning"><i class="fa fa-check"></i><b>16.3</b> Data parsing and cleaning</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="lab-ggplot2.html"><a href="lab-ggplot2.html"><i class="fa fa-check"></i><b>17</b> Lab - ggplot2</a></li>
<li class="chapter" data-level="18" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>18</b> Exploratory data analysis</a><ul>
<li class="chapter" data-level="18.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#introduction-9"><i class="fa fa-check"></i><b>18.1</b> Introduction</a></li>
<li class="chapter" data-level="18.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#a-note-on-packages"><i class="fa fa-check"></i><b>18.2</b> A note on packages</a></li>
<li class="chapter" data-level="18.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#ttc-subway-delays"><i class="fa fa-check"></i><b>18.3</b> TTC subway delays</a></li>
<li class="chapter" data-level="18.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#eda-and-data-viz"><i class="fa fa-check"></i><b>18.4</b> EDA and data viz</a></li>
<li class="chapter" data-level="18.5" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#data-checks"><i class="fa fa-check"></i><b>18.5</b> Data checks</a><ul>
<li class="chapter" data-level="18.5.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#sanity-checks"><i class="fa fa-check"></i><b>18.5.1</b> Sanity Checks</a></li>
<li class="chapter" data-level="18.5.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#missing-values"><i class="fa fa-check"></i><b>18.5.2</b> Missing values</a></li>
<li class="chapter" data-level="18.5.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#duplicates"><i class="fa fa-check"></i><b>18.5.3</b> Duplicates?</a></li>
<li class="chapter" data-level="18.5.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#visualizing-distributions"><i class="fa fa-check"></i><b>18.5.4</b> Visualizing distributions</a></li>
<li class="chapter" data-level="18.5.5" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#visualizing-time-series"><i class="fa fa-check"></i><b>18.5.5</b> Visualizing time series</a></li>
<li class="chapter" data-level="18.5.6" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#visualizing-relationships"><i class="fa fa-check"></i><b>18.5.6</b> Visualizing relationships</a></li>
<li class="chapter" data-level="18.5.7" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#pca"><i class="fa fa-check"></i><b>18.5.7</b> PCA</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#exercises"><i class="fa fa-check"></i><b>18.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="case-study-historical-canadian-elections.html"><a href="case-study-historical-canadian-elections.html"><i class="fa fa-check"></i><b>19</b> Case study - Historical Canadian elections</a></li>
<li class="chapter" data-level="20" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>20</b> Linear regression</a><ul>
<li class="chapter" data-level="20.1" data-path="linear-regression.html"><a href="linear-regression.html#introduction-10"><i class="fa fa-check"></i><b>20.1</b> Introduction</a></li>
<li class="chapter" data-level="20.2" data-path="linear-regression.html"><a href="linear-regression.html#competing-relationships"><i class="fa fa-check"></i><b>20.2</b> Competing relationships</a></li>
<li class="chapter" data-level="20.3" data-path="linear-regression.html"><a href="linear-regression.html#implementing-this-in-r"><i class="fa fa-check"></i><b>20.3</b> Implementing this in R</a></li>
<li class="chapter" data-level="20.4" data-path="linear-regression.html"><a href="linear-regression.html#tidy-up-with-broom"><i class="fa fa-check"></i><b>20.4</b> Tidy up with broom</a></li>
<li class="chapter" data-level="20.5" data-path="linear-regression.html"><a href="linear-regression.html#testing-hypothesis"><i class="fa fa-check"></i><b>20.5</b> Testing hypothesis</a></li>
<li class="chapter" data-level="20.6" data-path="linear-regression.html"><a href="linear-regression.html#adding-more-and-varied-explanatory-variables"><i class="fa fa-check"></i><b>20.6</b> Adding more and varied explanatory variables</a></li>
<li class="chapter" data-level="20.7" data-path="linear-regression.html"><a href="linear-regression.html#threats-to-validity-and-aspects-to-think-about"><i class="fa fa-check"></i><b>20.7</b> Threats to validity and aspects to think about</a></li>
<li class="chapter" data-level="20.8" data-path="linear-regression.html"><a href="linear-regression.html#more-credible-outputs"><i class="fa fa-check"></i><b>20.8</b> More credible outputs</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="lab-reporting-regression-results.html"><a href="lab-reporting-regression-results.html"><i class="fa fa-check"></i><b>21</b> Lab - Reporting regression results</a></li>
<li class="chapter" data-level="22" data-path="case-study-opinions-about-a-casino-in-toronto.html"><a href="case-study-opinions-about-a-casino-in-toronto.html"><i class="fa fa-check"></i><b>22</b> Case study - Opinions about a casino in Toronto</a><ul>
<li class="chapter" data-level="22.1" data-path="case-study-opinions-about-a-casino-in-toronto.html"><a href="case-study-opinions-about-a-casino-in-toronto.html#data-preparation"><i class="fa fa-check"></i><b>22.1</b> Data preparation</a><ul>
<li class="chapter" data-level="22.1.1" data-path="case-study-opinions-about-a-casino-in-toronto.html"><a href="case-study-opinions-about-a-casino-in-toronto.html#getting-data-from-opendatatoronto"><i class="fa fa-check"></i><b>22.1.1</b> Getting data from <code>opendatatoronto</code></a></li>
<li class="chapter" data-level="22.1.2" data-path="case-study-opinions-about-a-casino-in-toronto.html"><a href="case-study-opinions-about-a-casino-in-toronto.html#getting-the-right-kind-of-object"><i class="fa fa-check"></i><b>22.1.2</b> Getting the right kind of object</a></li>
<li class="chapter" data-level="22.1.3" data-path="case-study-opinions-about-a-casino-in-toronto.html"><a href="case-study-opinions-about-a-casino-in-toronto.html#cleaning-up-the-dataframe"><i class="fa fa-check"></i><b>22.1.3</b> Cleaning up the dataframe</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="case-study-opinions-about-a-casino-in-toronto.html"><a href="case-study-opinions-about-a-casino-in-toronto.html#some-visual-exploration-and-more-cleanup-of-course"><i class="fa fa-check"></i><b>22.2</b> Some visual exploration (and more cleanup, of course)</a><ul>
<li class="chapter" data-level="22.2.1" data-path="case-study-opinions-about-a-casino-in-toronto.html"><a href="case-study-opinions-about-a-casino-in-toronto.html#getting-the-data-into-a-more-model-suitable-format"><i class="fa fa-check"></i><b>22.2.1</b> Getting the data into a more model-suitable format</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="case-study-opinions-about-a-casino-in-toronto.html"><a href="case-study-opinions-about-a-casino-in-toronto.html#logistic-regression"><i class="fa fa-check"></i><b>22.3</b> Logistic Regression</a><ul>
<li class="chapter" data-level="22.3.1" data-path="case-study-opinions-about-a-casino-in-toronto.html"><a href="case-study-opinions-about-a-casino-in-toronto.html#interpretation"><i class="fa fa-check"></i><b>22.3.1</b> Interpretation</a></li>
<li class="chapter" data-level="22.3.2" data-path="case-study-opinions-about-a-casino-in-toronto.html"><a href="case-study-opinions-about-a-casino-in-toronto.html#baseline-category"><i class="fa fa-check"></i><b>22.3.2</b> Baseline category</a></li>
<li class="chapter" data-level="22.3.3" data-path="case-study-opinions-about-a-casino-in-toronto.html"><a href="case-study-opinions-about-a-casino-in-toronto.html#making-estimates"><i class="fa fa-check"></i><b>22.3.3</b> Making estimates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="case-study-airbnb-listing-in-toronto.html"><a href="case-study-airbnb-listing-in-toronto.html"><i class="fa fa-check"></i><b>23</b> Case study - Airbnb listing in Toronto</a><ul>
<li class="chapter" data-level="23.1" data-path="case-study-airbnb-listing-in-toronto.html"><a href="case-study-airbnb-listing-in-toronto.html#essentials"><i class="fa fa-check"></i><b>23.1</b> Essentials</a></li>
<li class="chapter" data-level="23.2" data-path="case-study-airbnb-listing-in-toronto.html"><a href="case-study-airbnb-listing-in-toronto.html#set-up"><i class="fa fa-check"></i><b>23.2</b> Set up</a></li>
<li class="chapter" data-level="23.3" data-path="case-study-airbnb-listing-in-toronto.html"><a href="case-study-airbnb-listing-in-toronto.html#get-data"><i class="fa fa-check"></i><b>23.3</b> Get data</a></li>
<li class="chapter" data-level="23.4" data-path="case-study-airbnb-listing-in-toronto.html"><a href="case-study-airbnb-listing-in-toronto.html#clean-data"><i class="fa fa-check"></i><b>23.4</b> Clean data</a><ul>
<li class="chapter" data-level="23.4.1" data-path="case-study-airbnb-listing-in-toronto.html"><a href="case-study-airbnb-listing-in-toronto.html#price"><i class="fa fa-check"></i><b>23.4.1</b> Price</a></li>
<li class="chapter" data-level="23.4.2" data-path="case-study-airbnb-listing-in-toronto.html"><a href="case-study-airbnb-listing-in-toronto.html#superhosts"><i class="fa fa-check"></i><b>23.4.2</b> Superhosts</a></li>
<li class="chapter" data-level="23.4.3" data-path="case-study-airbnb-listing-in-toronto.html"><a href="case-study-airbnb-listing-in-toronto.html#reviews"><i class="fa fa-check"></i><b>23.4.3</b> Reviews</a></li>
<li class="chapter" data-level="23.4.4" data-path="case-study-airbnb-listing-in-toronto.html"><a href="case-study-airbnb-listing-in-toronto.html#response-time"><i class="fa fa-check"></i><b>23.4.4</b> Response time</a></li>
<li class="chapter" data-level="23.4.5" data-path="case-study-airbnb-listing-in-toronto.html"><a href="case-study-airbnb-listing-in-toronto.html#host-number-of-listings"><i class="fa fa-check"></i><b>23.4.5</b> Host number of listings</a></li>
<li class="chapter" data-level="23.4.6" data-path="case-study-airbnb-listing-in-toronto.html"><a href="case-study-airbnb-listing-in-toronto.html#decisions"><i class="fa fa-check"></i><b>23.4.6</b> Decisions</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="case-study-airbnb-listing-in-toronto.html"><a href="case-study-airbnb-listing-in-toronto.html#explore-data"><i class="fa fa-check"></i><b>23.5</b> Explore data</a><ul>
<li class="chapter" data-level="23.5.1" data-path="case-study-airbnb-listing-in-toronto.html"><a href="case-study-airbnb-listing-in-toronto.html#price-and-reviews"><i class="fa fa-check"></i><b>23.5.1</b> Price and reviews</a></li>
<li class="chapter" data-level="23.5.2" data-path="case-study-airbnb-listing-in-toronto.html"><a href="case-study-airbnb-listing-in-toronto.html#superhost-and-response-time"><i class="fa fa-check"></i><b>23.5.2</b> Superhost and response-time</a></li>
<li class="chapter" data-level="23.5.3" data-path="case-study-airbnb-listing-in-toronto.html"><a href="case-study-airbnb-listing-in-toronto.html#neighbourhood"><i class="fa fa-check"></i><b>23.5.3</b> Neighbourhood</a></li>
</ul></li>
<li class="chapter" data-level="23.6" data-path="case-study-airbnb-listing-in-toronto.html"><a href="case-study-airbnb-listing-in-toronto.html#model-data"><i class="fa fa-check"></i><b>23.6</b> Model data</a><ul>
<li class="chapter" data-level="23.6.1" data-path="case-study-airbnb-listing-in-toronto.html"><a href="case-study-airbnb-listing-in-toronto.html#logistic-regression-1"><i class="fa fa-check"></i><b>23.6.1</b> Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="23.7" data-path="case-study-airbnb-listing-in-toronto.html"><a href="case-study-airbnb-listing-in-toronto.html#next-steps"><i class="fa fa-check"></i><b>23.7</b> Next steps</a></li>
<li class="chapter" data-level="23.8" data-path="case-study-airbnb-listing-in-toronto.html"><a href="case-study-airbnb-listing-in-toronto.html#references"><i class="fa fa-check"></i><b>23.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="ab-testing-and-rcts.html"><a href="ab-testing-and-rcts.html"><i class="fa fa-check"></i><b>24</b> A/B testing and RCTs</a><ul>
<li class="chapter" data-level="24.1" data-path="ab-testing-and-rcts.html"><a href="ab-testing-and-rcts.html#introduction-11"><i class="fa fa-check"></i><b>24.1</b> Introduction</a></li>
<li class="chapter" data-level="24.2" data-path="ab-testing-and-rcts.html"><a href="ab-testing-and-rcts.html#motivation"><i class="fa fa-check"></i><b>24.2</b> Motivation</a></li>
<li class="chapter" data-level="24.3" data-path="ab-testing-and-rcts.html"><a href="ab-testing-and-rcts.html#tea-party"><i class="fa fa-check"></i><b>24.3</b> Tea party</a></li>
<li class="chapter" data-level="24.4" data-path="ab-testing-and-rcts.html"><a href="ab-testing-and-rcts.html#some-unexpected-properties-from-randomised-sampling"><i class="fa fa-check"></i><b>24.4</b> Some unexpected properties from randomised sampling</a></li>
<li class="chapter" data-level="24.5" data-path="ab-testing-and-rcts.html"><a href="ab-testing-and-rcts.html#anova"><i class="fa fa-check"></i><b>24.5</b> ANOVA</a></li>
<li class="chapter" data-level="24.6" data-path="ab-testing-and-rcts.html"><a href="ab-testing-and-rcts.html#treatment-and-control"><i class="fa fa-check"></i><b>24.6</b> Treatment and control</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="matching-difference-in-differences.html"><a href="matching-difference-in-differences.html"><i class="fa fa-check"></i><b>25</b> Matching &amp; difference-in-differences</a><ul>
<li class="chapter" data-level="25.1" data-path="matching-difference-in-differences.html"><a href="matching-difference-in-differences.html#introduction-12"><i class="fa fa-check"></i><b>25.1</b> Introduction</a></li>
<li class="chapter" data-level="25.2" data-path="matching-difference-in-differences.html"><a href="matching-difference-in-differences.html#motivation-1"><i class="fa fa-check"></i><b>25.2</b> Motivation</a></li>
<li class="chapter" data-level="25.3" data-path="matching-difference-in-differences.html"><a href="matching-difference-in-differences.html#example"><i class="fa fa-check"></i><b>25.3</b> Example</a></li>
<li class="chapter" data-level="25.4" data-path="matching-difference-in-differences.html"><a href="matching-difference-in-differences.html#assumptions"><i class="fa fa-check"></i><b>25.4</b> Assumptions</a></li>
<li class="chapter" data-level="25.5" data-path="matching-difference-in-differences.html"><a href="matching-difference-in-differences.html#matching"><i class="fa fa-check"></i><b>25.5</b> Matching</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="case-study-lower-advertising-revenue-reduced-french-newspaper-prices-between-1960-and-1974.html"><a href="case-study-lower-advertising-revenue-reduced-french-newspaper-prices-between-1960-and-1974.html"><i class="fa fa-check"></i><b>26</b> Case study - Lower advertising revenue reduced French newspaper prices between 1960 and 1974</a><ul>
<li class="chapter" data-level="26.1" data-path="case-study-lower-advertising-revenue-reduced-french-newspaper-prices-between-1960-and-1974.html"><a href="case-study-lower-advertising-revenue-reduced-french-newspaper-prices-between-1960-and-1974.html#introduction-13"><i class="fa fa-check"></i><b>26.1</b> Introduction</a></li>
<li class="chapter" data-level="26.2" data-path="case-study-lower-advertising-revenue-reduced-french-newspaper-prices-between-1960-and-1974.html"><a href="case-study-lower-advertising-revenue-reduced-french-newspaper-prices-between-1960-and-1974.html#background"><i class="fa fa-check"></i><b>26.2</b> Background</a></li>
<li class="chapter" data-level="26.3" data-path="case-study-lower-advertising-revenue-reduced-french-newspaper-prices-between-1960-and-1974.html"><a href="case-study-lower-advertising-revenue-reduced-french-newspaper-prices-between-1960-and-1974.html#data-1"><i class="fa fa-check"></i><b>26.3</b> Data</a></li>
<li class="chapter" data-level="26.4" data-path="case-study-lower-advertising-revenue-reduced-french-newspaper-prices-between-1960-and-1974.html"><a href="case-study-lower-advertising-revenue-reduced-french-newspaper-prices-between-1960-and-1974.html#model-1"><i class="fa fa-check"></i><b>26.4</b> Model</a></li>
<li class="chapter" data-level="26.5" data-path="case-study-lower-advertising-revenue-reduced-french-newspaper-prices-between-1960-and-1974.html"><a href="case-study-lower-advertising-revenue-reduced-french-newspaper-prices-between-1960-and-1974.html#results"><i class="fa fa-check"></i><b>26.5</b> Results</a></li>
<li class="chapter" data-level="26.6" data-path="case-study-lower-advertising-revenue-reduced-french-newspaper-prices-between-1960-and-1974.html"><a href="case-study-lower-advertising-revenue-reduced-french-newspaper-prices-between-1960-and-1974.html#other-points"><i class="fa fa-check"></i><b>26.6</b> Other points</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="shiny-applications.html"><a href="shiny-applications.html"><i class="fa fa-check"></i><b>27</b> Shiny applications</a></li>
<li class="chapter" data-level="28" data-path="regression-discontinuity-design.html"><a href="regression-discontinuity-design.html"><i class="fa fa-check"></i><b>28</b> Regression discontinuity design</a></li>
<li class="chapter" data-level="29" data-path="introduction-14.html"><a href="introduction-14.html"><i class="fa fa-check"></i><b>29</b> Introduction</a></li>
<li class="chapter" data-level="30" data-path="instrumental-variables.html"><a href="instrumental-variables.html"><i class="fa fa-check"></i><b>30</b> Instrumental variables</a></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Telling Stories with Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ab-testing-and-rcts" class="section level1">
<h1><span class="header-section-number">24</span> A/B testing and RCTs</h1>
<p><strong>Required reading</strong></p>
<ul>
<li>Fisher, Ronald, 1935, ‘The Design of Experiments’, pp. 20-29, freely available at: <a href="https://archive.org/details/in.ernet.dli.2015.502684/page/n33/mode/2up" class="uri">https://archive.org/details/in.ernet.dli.2015.502684/page/n33/mode/2up</a>.</li>
<li>Gertler, Paul, Sebastian Martinez, Patrick Premand, Laura Rawlings, and Christel Vermeersch, ‘Impact Evaluation in Practice’, Chapter 4.</li>
</ul>
<p><strong>Recommended reading</strong></p>
<ul>
<li>Banerjee, Abhijit Vinayak, Esther Duflo, Rachel Glennerster, and Dhruva Kothari, 2010, ‘Improving immunisation coverage in rural India: clustered randomised controlled evaluation of immunisation campaigns with and without incentives’, <em>BMJ</em>, 340, c2220.</li>
<li>Dablander, Fabian, 2020, “An Introduction to Causal Inference”, <em>PsyArXiv</em>, 13 February, <a href="doi:10.31234/osf.io/b3fkw" class="uri">doi:10.31234/osf.io/b3fkw</a>, freely available at: <a href="https://psyarxiv.com/b3fkw" class="uri">https://psyarxiv.com/b3fkw</a>.</li>
<li>Deaton, Angus, 2010, ‘Instruments, Randomization, and Learning about Development’, <em>Journal of Economic Literature</em>, vol. 48, no. 2, pp. 424-455.</li>
<li>Duflo, Esther, Rachel Glennerster, and Michael Kremer, 2007, ‘Using Randomization In Development Economics Research: A Toolkit’, freely available at: <a href="https://economics.mit.edu/files/806" class="uri">https://economics.mit.edu/files/806</a>.</li>
<li>Gordon, Brett R., Florian Zettelmeyer, Neha Bhargava, and Dan Chapsky, 2019, ‘A Comparison of Approaches to Advertising Measurement: Evidence from Big Field Experiments at Facebook’, <em>Marketing Science</em>, Vol. 38, No. 2, March–April, pp. 193–225.</li>
<li>Jeffries, Adrianne, Leon Yin, and Surya Mattu, 2020, ‘Swinging the Vote?’, <em>The Markup</em>, 26 February, freely available at: <a href="https://themarkup.org/google-the-giant/2020/02/26/wheres-my-email" class="uri">https://themarkup.org/google-the-giant/2020/02/26/wheres-my-email</a>.</li>
<li>Lewis, Randall A., and David H. Reiley, 2014 ‘Online ads and offline sales: Measuring the effects of retail advertising via a controlled experiment on Yahoo!’, <em>Quantitative Marketing and Economics</em>, Vol 12, pp. 235–266.</li>
<li>Ryan, A. C., A. R. MacKenzie, S. Watkins, and R. Timmis, 2012, ‘World War II contrails: a case study of aviation‐induced cloudiness’, <em>International journal of climatology</em>, 32, no. 11, pp. 1745-1753.</li>
<li>Stolberg, Michael, 2006, ‘Inventing the randomized double-blind trial: the Nuremberg salt test of 1835’, <em>Journal of the Royal Society of Medicine</em>, 99, no. 12, pp. 642-643.</li>
<li>Sveriges Riksbank Prize in Economic Sciences in Memory of Alfred Nobel, 2019, popular science background, freely available at: <a href="https://www.nobelprize.org/uploads/2019/10/popular-economicsciencesprize2019-2.pdf" class="uri">https://www.nobelprize.org/uploads/2019/10/popular-economicsciencesprize2019-2.pdf</a>.</li>
<li>Sveriges Riksbank Prize in Economic Sciences in Memory of Alfred Nobel, 2019, scientific background, freely available at: <a href="https://www.nobelprize.org/uploads/2019/10/advanced-economicsciencesprize2019.pdf" class="uri">https://www.nobelprize.org/uploads/2019/10/advanced-economicsciencesprize2019.pdf</a>.</li>
<li>Taddy, Matt, 2019, <em>Business Data Science</em>, Chapter 5.</li>
<li>Urban, Steve, Rangarajan Sreenivasan, and Vineet Kannan, 2016, ‘It’s All A/Bout Testing: The Netflix Experimentation Platform’, <em>Netflix Technology Blog</em>, 29 April, freely available at: <a href="https://netflixtechblog.com/its-all-a-bout-testing-the-netflix-experimentation-platform-4e1ca458c15" class="uri">https://netflixtechblog.com/its-all-a-bout-testing-the-netflix-experimentation-platform-4e1ca458c15</a>.</li>
</ul>
<p><strong>Key concepts/skills/etc</strong></p>
<ul>
<li>Treatment and control groups.</li>
<li>Internal and external validity.</li>
<li>Average treatment effect.</li>
<li>Generating simulated datasets.</li>
</ul>
<p><strong>Key libraries</strong></p>
<ul>
<li><code>broom</code></li>
<li><code>ggplot2</code></li>
<li><code>tidyverse</code></li>
</ul>
<p><strong>Key functions/etc</strong></p>
<ul>
<li><code>aov()</code></li>
<li><code>rnorm()</code></li>
<li><code>sample()</code></li>
<li><code>t.test()</code></li>
</ul>
<p><strong>Pre-quiz</strong></p>
<ol style="list-style-type: decimal">
<li>In your own words, what is the role of randomisation in constructing a counterfactual?</li>
<li>What is external validity? What is internal validity?</li>
<li>If we have a dataset named ‘netflix_data’, with the columns ‘person’ and ‘tv_show’ and ‘hours’, (person is a character class uniqueID for every person, tv_show is a character class name of a tv show, and hours is double expressing the number of hours that person watched that tv show). Could you please write some code that would randomly assign people into one of two groups? The data looks like this:</li>
</ol>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb348-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb348-2" data-line-number="2">netflix_data &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb348-3" data-line-number="3"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">person =</span> <span class="kw">c</span>(<span class="st">&quot;Rohan&quot;</span>, <span class="st">&quot;Rohan&quot;</span>, <span class="st">&quot;Monica&quot;</span>, <span class="st">&quot;Monica&quot;</span>, <span class="st">&quot;Monica&quot;</span>, <span class="st">&quot;Patricia&quot;</span>, <span class="st">&quot;Patricia&quot;</span>, <span class="st">&quot;Helen&quot;</span>),</a>
<a class="sourceLine" id="cb348-4" data-line-number="4">         <span class="dt">tv_show =</span> <span class="kw">c</span>(<span class="st">&quot;Broadchurch&quot;</span>, <span class="st">&quot;Duty-Shame&quot;</span>, <span class="st">&quot;Broadchurch&quot;</span>, <span class="st">&quot;Duty-Shame&quot;</span>, <span class="st">&quot;Shetland&quot;</span>, <span class="st">&quot;Broadchurch&quot;</span>, <span class="st">&quot;Shetland&quot;</span>, <span class="st">&quot;Duty-Shame&quot;</span>),</a>
<a class="sourceLine" id="cb348-5" data-line-number="5">         <span class="dt">hours =</span> <span class="kw">c</span>(<span class="fl">6.8</span>, <span class="fl">8.0</span>, <span class="fl">0.8</span>, <span class="fl">9.2</span>, <span class="fl">3.2</span>, <span class="fl">4.0</span>, <span class="fl">0.2</span>, <span class="fl">10.2</span>)</a>
<a class="sourceLine" id="cb348-6" data-line-number="6">         )</a></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>What does stratification mean to you (in the context of randomisation)?</li>
<li>How could you check that your randomisation had been done appropriately?</li>
</ol>
<div id="introduction-11" class="section level2">
<h2><span class="header-section-number">24.1</span> Introduction</h2>
<p><em>First a note on Ronald Fisher and Francis Galton. Fisher and Galton are the intellectual grandfathers of much of the work that we cover in this chapter. In some cases it is directly their work, in other cases it is work that built on their contributions. Both of these men believed in eugenics, amongst other things that we would generally find reprehensible today.</em></p>
<p>This chapter is about experiments. This is a situation in which we can explicitly control and vary some aspects. The advantage of this is that identification should be clear. There is a treatment group that is treated and a control group that is not. These are randomly split. And so if they end up different then it must be because of the treatment. Unfortunately, life is rarely so smooth. Arguing about how similar the treatment and control groups were tends to carry on indefinitely, because our ability to speak to internal validity affects our ability to speak to external validity.</p>
</div>
<div id="motivation" class="section level2">
<h2><span class="header-section-number">24.2</span> Motivation</h2>
<blockquote>
<p>Never forget: if your sampling is in any way non-representative, your observe[d] data is not sufficient for population estimates. You <em>must</em> deal with design, sampling issues, data quality, and misclassification. Otherwise you’ll just be wrong.</p>
<p>Dan Simpson, <a href="https://twitter.com/dan_p_simpson/status/1222924987667046400">30 January 2020</a>.</p>
</blockquote>
<p>When Monica and I moved to San Francisco, the Giants immediately won the baseball, and the Warriors began a historic streak. We moved to Chicago and the Cubs won the baseball for the first time in a hundred years. We then moved to Massachusetts, and the Patriots won the Super Bowl again and again and again. Finally, we moved to Toronto, and the Raptors won the basketball. Should a city pay us to live there or could their funds be better spent elsewhere?</p>
<p>One way to get at the answer would be to run an experiment. Make a list of the North American cities with major sports teams, and then roll a dice and send us to live there for a year. If we had enough lifetimes, then we could work it out. But by using A/B testing and experiments we can try to use a larger sample size to work out causality a little more quickly.</p>
</div>
<div id="tea-party" class="section level2">
<h2><span class="header-section-number">24.3</span> Tea party</h2>
<p>Fisher introduced a, now, famous example of an experiment designed to see if a person can distinguish between a cup of tea when the milk was added first, or last (this matters a lot to my father). The set-up is:</p>
<ul>
<li>Eight randomly ordered cups of tea.</li>
<li>Four had tea put in first.</li>
<li>Four had milk put in first.</li>
<li>The person has to choose the four that are the same.</li>
<li>The person knows it’s an experiment.</li>
</ul>
<p>We’ll now try this experiment.</p>
<p>To decide if the person’s choices were likely to have occured at random or not, we need to think about the probability of this happening by chance. First count the number of successes out of the four that were chosen. There are: <span class="math inline">\({8 \choose 4} = \frac{8!}{4!(8-4)!}\)</span> 70 possible outcomes.</p>
<p>By chance, there are two ways for the person to be perfectly correct (because we are only asking them to be grouped): correctly identify all the ones that were milk-first (one outcome out of 70) or correctly identify all the ones that were tea-first (one outcome out of 70), so the chance of that is <span class="math inline">\(2/70 \approx 0.028\)</span>. So if the null is that they can’t distinguish, but they correctly separate them all, then at the five-per-cent level, we reject the null!</p>
<p>What if they miss on? Similarly, by chance there are 16 ways for a person to be ‘off-by-one’. Either they think there was one that was milk-first when it was tea-first - there are, <span class="math inline">\({4 \choose 1}\)</span>, four ways this could happen - or they think there was one that was tea-first when it was milk-first - again, there are, <span class="math inline">\({4 \choose 1}\)</span>, four ways this could happen. But these outcomes are independent, so the probability is <span class="math inline">\(\frac{4\times 4}{70} \approx 0.228\)</span>. And so on. So, we fail to reject the null.</p>
</div>
<div id="some-unexpected-properties-from-randomised-sampling" class="section level2">
<h2><span class="header-section-number">24.4</span> Some unexpected properties from randomised sampling</h2>
<p>Correlation can be enough in some settings, but in order to be able to make forecasts when things change and the circumstances are slightly different we need to understand causation. The key is the counterfactual - what would have happened in the absence of the treatment. Ideally we could keep everything else constant, randomly divide the world into two groups, and then treat one and not the other. Then we can be pretty confident that any difference between the two groups is due to that treatment. The reason for this is that if we have some population and we randomly select two groups from it, then our two groups (so long as they are both big enough) should have the same characteristics as the population. Randomised controlled trials (RCTs) and A/B testing attempts to get us as close to this ‘gold standard’ as we can hope. (This is often described as the ‘gold standard’. In doing so, it’s not to say that it’s perfect, just that it’s generally better than most of the other options. There is plenty that is wrong with it.)</p>
<p>To see this, let’s generate a simulated dataset and then sample from it. (In general, this is a good way to approach problems: 1) generate a simulated dataset; 2) do your analysis on the simulated dataset; 3) take your analysis to the real dataset. The reason this is a good approach is that you know roughly what the outcomes should be in step 2, whereas if you go directly to the real dataset then you don’t know if unexpected outcomes are likely due to your own analysis errors, or actual results. The first time you generate a simulated dataset it will take a while, but after a bit of practice you’ll get good at it. There are also packages that can help, including <a href="https://declaredesign.org/">DeclareDesign</a>.)</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb349-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb349-2" data-line-number="2"></a>
<a class="sourceLine" id="cb349-3" data-line-number="3"><span class="kw">set.seed</span>(<span class="dv">853</span>)</a>
<a class="sourceLine" id="cb349-4" data-line-number="4"><span class="co"># Construct a population so that 25 per cent of people like blue and 75 per cent </span></a>
<a class="sourceLine" id="cb349-5" data-line-number="5"><span class="co"># like white.</span></a>
<a class="sourceLine" id="cb349-6" data-line-number="6">population &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb349-7" data-line-number="7"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">person =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>),</a>
<a class="sourceLine" id="cb349-8" data-line-number="8">         <span class="dt">favourite_color =</span> <span class="kw">sample</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;Blue&quot;</span>, <span class="st">&quot;White&quot;</span>), </a>
<a class="sourceLine" id="cb349-9" data-line-number="9">                                  <span class="dt">size  =</span> <span class="dv">10000</span>, </a>
<a class="sourceLine" id="cb349-10" data-line-number="10">                                  <span class="dt">replace =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb349-11" data-line-number="11">                                  <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>)),</a>
<a class="sourceLine" id="cb349-12" data-line-number="12">         <span class="dt">supports_the_leafs =</span> <span class="kw">sample</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>), </a>
<a class="sourceLine" id="cb349-13" data-line-number="13">                                  <span class="dt">size  =</span> <span class="dv">10000</span>, </a>
<a class="sourceLine" id="cb349-14" data-line-number="14">                                  <span class="dt">replace =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb349-15" data-line-number="15">                                  <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.80</span>, <span class="fl">0.20</span>)),</a>
<a class="sourceLine" id="cb349-16" data-line-number="16">         ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb349-17" data-line-number="17"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">in_frame =</span> <span class="kw">sample</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb349-18" data-line-number="18">                        <span class="dt">size  =</span> <span class="dv">10000</span>, </a>
<a class="sourceLine" id="cb349-19" data-line-number="19">                        <span class="dt">replace =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb349-20" data-line-number="20"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">group =</span> <span class="kw">sample</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>),</a>
<a class="sourceLine" id="cb349-21" data-line-number="21">                        <span class="dt">size  =</span> <span class="dv">10000</span>, </a>
<a class="sourceLine" id="cb349-22" data-line-number="22">                        <span class="dt">replace =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb349-23" data-line-number="23"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">group =</span> <span class="kw">ifelse</span>(in_frame <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, group, <span class="ot">NA</span>))</a></code></pre></div>
<p>Now look at the mean for two groups drawn out of it.</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb350-1" data-line-number="1">population <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb350-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(in_frame <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb350-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(group <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb350-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(group, favourite_color) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb350-5" data-line-number="5"><span class="st">  </span><span class="kw">count</span>()</a></code></pre></div>
<pre><code>## # A tibble: 4 x 3
## # Groups:   group, favourite_color [4]
##   group favourite_color     n
##   &lt;int&gt; &lt;chr&gt;           &lt;int&gt;
## 1     1 Blue              114
## 2     1 White             420
## 3     2 Blue              105
## 4     2 White             369</code></pre>
<p>We are probably convinced by looking at it, but to formally test if there is a difference in the two samples, we can use a t-test.</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb352-1" data-line-number="1">population &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb352-2" data-line-number="2"><span class="st">  </span>population <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb352-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">color_as_integer =</span> <span class="kw">case_when</span>(</a>
<a class="sourceLine" id="cb352-4" data-line-number="4">    favourite_color <span class="op">==</span><span class="st"> &quot;White&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb352-5" data-line-number="5">    favourite_color <span class="op">==</span><span class="st"> &quot;Blue&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb352-6" data-line-number="6">    <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">999</span></a>
<a class="sourceLine" id="cb352-7" data-line-number="7">  ))</a>
<a class="sourceLine" id="cb352-8" data-line-number="8"></a>
<a class="sourceLine" id="cb352-9" data-line-number="9">group_<span class="dv">1</span> &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb352-10" data-line-number="10"><span class="st">  </span>population <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb352-11" data-line-number="11"><span class="st">  </span><span class="kw">filter</span>(group <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb352-12" data-line-number="12"><span class="st">  </span><span class="kw">select</span>(color_as_integer) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb352-13" data-line-number="13"><span class="st">  </span><span class="kw">as.vector</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb352-14" data-line-number="14"><span class="st">  </span><span class="kw">unlist</span>()</a>
<a class="sourceLine" id="cb352-15" data-line-number="15"></a>
<a class="sourceLine" id="cb352-16" data-line-number="16">group_<span class="dv">2</span> &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb352-17" data-line-number="17"><span class="st">  </span>population <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb352-18" data-line-number="18"><span class="st">  </span><span class="kw">filter</span>(group <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb352-19" data-line-number="19"><span class="st">  </span><span class="kw">select</span>(color_as_integer) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb352-20" data-line-number="20"><span class="st">  </span><span class="kw">unlist</span>()</a>
<a class="sourceLine" id="cb352-21" data-line-number="21"></a>
<a class="sourceLine" id="cb352-22" data-line-number="22"><span class="kw">t.test</span>(group_<span class="dv">1</span>, group_<span class="dv">2</span>)</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  group_1 and group_2
## t = -0.30825, df = 988.57, p-value = 0.758
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.05919338  0.04312170
## sample estimates:
## mean of x mean of y 
## 0.2134831 0.2215190</code></pre>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb354-1" data-line-number="1"><span class="co"># We could also use the tidy function in the broom package.</span></a>
<a class="sourceLine" id="cb354-2" data-line-number="2"><span class="kw">tidy</span>(<span class="kw">t.test</span>(group_<span class="dv">1</span>, group_<span class="dv">2</span>))</a></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; margin-bottom: 2em; margin-top: 2em; width: 100%; margin-left: 0%; margin-right: auto;  ">
<col><col><col><col><col><col><col><col><col><col><tr>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">estimate</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">estimate1</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">estimate2</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">statistic</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">p.value</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">parameter</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">conf.low</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">conf.high</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">method</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">alternative</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">-0.00804</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.213</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.222</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">-0.308</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.758</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">989</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">-0.0592</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.0431</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">Welch Two Sample t-test</td>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">two.sided</td>
</tr>
</table>

<p>If properly done then not only will we get a ‘representative’ share of people with the favourite color blue, but we should also get a representative share of people who support the Maple Leafs. Why should that happen when we haven’t randomised on these variables? Let’s start by looking at our dataset.</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb355-1" data-line-number="1">population <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb355-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(in_frame <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb355-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(group <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb355-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(group, supports_the_leafs) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb355-5" data-line-number="5"><span class="st">  </span><span class="kw">count</span>()</a></code></pre></div>
<pre><code>## # A tibble: 4 x 3
## # Groups:   group, supports_the_leafs [4]
##   group supports_the_leafs     n
##   &lt;int&gt; &lt;chr&gt;              &lt;int&gt;
## 1     1 No                   102
## 2     1 Yes                  432
## 3     2 No                    81
## 4     2 Yes                  393</code></pre>
<p>This is very powerful. We have a representative share on ‘unobservables’ (in this case we do ‘observe’ them - to illustrate the point - but we didn’t select on them). But it will break-down in a number of ways that we will discuss. It also assumes large enough groups - if we sampled in Toronto are we likely to get a ‘representative’ share of people who support the Canadiens? What about <a href="https://www.fc-hansa.de/">F.C. Hansa Rostock</a>? If we want to check that the two groups are the same then what can we do? Exactly what we did above - just check if we can identify a difference between the two groups based on observables (we looked at the mean, but we could look at other aspects as well).</p>
</div>
<div id="anova" class="section level2">
<h2><span class="header-section-number">24.5</span> ANOVA</h2>
<p>Analysis of Variation (ANOVA) was introduced by Fisher while he was working on statistical problems in agriculture (to steal a joke from Darren L Dahly, cited in an earlier reading, “Q: What’s the difference between agricultural and medical research?” “A: The former isn’t conducted by farmers.”). Typically, the null is that all of the groups are from the same distribution.</p>
<p>We can run ANOVA with the function built into R - <code>aov()</code>.</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb357-1" data-line-number="1">just_two_groups &lt;-<span class="st"> </span>population <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb357-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(in_frame <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb357-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(group <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb357-4" data-line-number="4"></a>
<a class="sourceLine" id="cb357-5" data-line-number="5"><span class="kw">aov</span>(group <span class="op">~</span><span class="st"> </span>favourite_color, </a>
<a class="sourceLine" id="cb357-6" data-line-number="6">    <span class="dt">data =</span> just_two_groups) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb357-7" data-line-number="7"><span class="st">  </span><span class="kw">tidy</span>()</a></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; margin-bottom: 2em; margin-top: 2em; width: 100%; margin-left: 0%; margin-right: auto;  ">
<col><col><col><col><col><col><tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">term</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">df</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">sumsq</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">meansq</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">statistic</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">p.value</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">favourite_color</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.0238</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.0238</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.0952</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.758</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt; padding: 4pt 4pt 4pt 4pt;">Residuals</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">1.01e+03</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">251&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">0.25&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">&nbsp;&nbsp;&nbsp;&nbsp;</td>
</tr>
</table>

<p>In this case, we fail to reject the null that the samples are the same.</p>
</div>
<div id="treatment-and-control" class="section level2">
<h2><span class="header-section-number">24.6</span> Treatment and control</h2>
<p>If the treated and control groups are the same in all ways and remain that way, then we have internal validity, which is to say that our control will work as a counterfactual and our results can speak to a difference between these groups. If the group to which we applied our randomisation were representative of the broader population, and the experimental set-up were fairly similar to outside conditions, then we further have external validity. That means that the difference that we find does not just apply in our own experiment, but also in the broader population. But this means we need randomisation twice. How does this trade-off happen and to what extent does it matter?</p>
<p>As such, we are interested in the effect of being ‘treated’. This may be that we charge different prices (continuous treatment variable), or that we compare different colours on a website (discrete treatment variable, and a staple of A/B testing). If we consider just discrete treatments (so that we can use dummy variables) then need to make sure that all of the groups are otherwise the same. How can we do this? One way is to ignore the treatment variable and to examine all other variables - can you detect a difference between the groups based on any other variables? In the website example, are there a similar number of:</p>
<ul>
<li>PC/Mac users?</li>
<li>Safari/Chrome/Firefox/other users?</li>
<li>Mobile/desktop users?</li>
<li>Users from certain locations?</li>
</ul>
<p>These are all threats to the validity of our claims.</p>
<p>But if done properly, that is if the treatment is truly independent, then we can estimate an ‘average treatment effect’, which in a binary treatment variable setting is:
<span class="math display">\[\mbox{ATE} = \mbox{E}[y|d=1] - \mbox{E}[y|d=0].\]</span></p>
<p>That is, the difference between the treated group, <span class="math inline">\(d = 1\)</span>, and the control group, <span class="math inline">\(d = 1\)</span>, when measured by the expected value of some outcome variable, <span class="math inline">\(y\)</span>. So the mean causal effect is simply the difference between the two expectations!</p>
<p>Let’s again get stuck into some code. First we need to generate some data.</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb358-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">853</span>)</a>
<a class="sourceLine" id="cb358-2" data-line-number="2">example_data &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">person =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>),</a>
<a class="sourceLine" id="cb358-3" data-line-number="3">                       <span class="dt">treatment =</span> <span class="kw">sample</span>(<span class="dt">x =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">size  =</span> <span class="dv">1000</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb358-4" data-line-number="4">                       )</a>
<a class="sourceLine" id="cb358-5" data-line-number="5"><span class="co"># We want to make the outcome slightly more likely if they were treated than if not.</span></a>
<a class="sourceLine" id="cb358-6" data-line-number="6">example_data &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb358-7" data-line-number="7"><span class="st">  </span>example_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb358-8" data-line-number="8"><span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb358-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">outcome =</span> <span class="kw">if_else</span>(treatment <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, </a>
<a class="sourceLine" id="cb358-10" data-line-number="10">                           <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb358-11" data-line-number="11">                           <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">6</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb358-12" data-line-number="12">                           )</a>
<a class="sourceLine" id="cb358-13" data-line-number="13">         )</a>
<a class="sourceLine" id="cb358-14" data-line-number="14"></a>
<a class="sourceLine" id="cb358-15" data-line-number="15">example_data<span class="op">$</span>treatment &lt;-<span class="st"> </span><span class="kw">as.factor</span>(example_data<span class="op">$</span>treatment)</a>
<a class="sourceLine" id="cb358-16" data-line-number="16"></a>
<a class="sourceLine" id="cb358-17" data-line-number="17">example_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb358-18" data-line-number="18"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> outcome, </a>
<a class="sourceLine" id="cb358-19" data-line-number="19">             <span class="dt">fill =</span> treatment)) <span class="op">+</span></a>
<a class="sourceLine" id="cb358-20" data-line-number="20"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>,</a>
<a class="sourceLine" id="cb358-21" data-line-number="21">                 <span class="dt">binwidth =</span> <span class="fl">0.2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb358-22" data-line-number="22"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb358-23" data-line-number="23"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Outcome&quot;</span>,</a>
<a class="sourceLine" id="cb358-24" data-line-number="24">       <span class="dt">y =</span> <span class="st">&quot;Number of people&quot;</span>,</a>
<a class="sourceLine" id="cb358-25" data-line-number="25">       <span class="dt">fill =</span> <span class="st">&quot;Person was treated&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb358-26" data-line-number="26"><span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Set1&quot;</span>)</a></code></pre></div>
<p><img src="notes_files/figure-html/unnamed-chunk-200-1.png" width="672" /></p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb359-1" data-line-number="1">example_regression &lt;-<span class="st"> </span><span class="kw">lm</span>(outcome <span class="op">~</span><span class="st"> </span>treatment, <span class="dt">data =</span> example_data)</a>
<a class="sourceLine" id="cb359-2" data-line-number="2"></a>
<a class="sourceLine" id="cb359-3" data-line-number="3"><span class="kw">tidy</span>(example_regression)</a></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: 0%; margin-right: auto;  ">
<col><col><col><col><col><tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">term</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">estimate</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">std.error</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">statistic</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">p.value</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">(Intercept)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">5&nbsp;&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.043&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">116&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt; padding: 4pt 4pt 4pt 4pt;">treatment1</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">1.01</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">0.0625</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">16.1</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">5.14e-52</td>
</tr>
</table>

<p>But then reality happens. Your experiment cannot run for too long otherwise people may be treated many times, or become inured to the treatment, but it cannot be too short otherwise you can’t measure longer term outcomes. You cannot have a ‘representative’ sample on every cross-tab, but if not then the treatment and control will be different. Practical difficulties may make it difficult to follow up with certain groups.</p>
<p>Questions to ask (if they haven’t been answered already) include:</p>
<ul>
<li>How are the participants being selected into the frame for consideration?</li>
<li>How are they being selected for treatment? We would hope this is a lottery, but this term is applied to a variety of situations. Additionally, early ‘success’ can lead to pressure to treat everyone.</li>
<li>How is treatment being assessed?</li>
<li>To what extent is random allocation ethical and fair? Some argue that shortages mean it is reasonable to randomly allocate, but that may depend on how linear the benefits are. It may also be difficult to establish boundaries. If we only want to include people in Ontario then that may be clear, but what about ‘students’ in Ontario - who is a student, and who is making the decision?</li>
</ul>
<p>Bias and other issues are not the end of the world. But you need to think about it carefully (Figure <a href="ab-testing-and-rcts.html#fig:planeexample">24.1</a>).</p>
<div class="figure"><span id="fig:planeexample"></span>
<img src="figures/bullet-holes.png" alt="A famous example of biased data" width="90%" />
<p class="caption">
Figure 24.1: A famous example of biased data
</p>
</div>
<p>Source: A variety of sources have this.</p>
<p>In the example, Abraham Wald was given data on the planes that came back to Britain after being shot at in WW2. The question is where to place the armour. One option is to place it over the bullet holes. Wald recognised that there is a selection effect here - these are the planes that made it back - they didn’t need the armour, but instead we should put the armour where there were no bullet holes.</p>
<p>To consider an example that may be closer to home - how would the results of a survey differ if I only asked students who completed this course what was difficult about it and not those who dropped out?</p>
<p>While, as Dan suggests, we should work to try to make the dataset as good as possible, it may be possible to use the model to control for some of the bias. If there is a variable that is correlated with say, attrition, then we can add it to the model. Either by itself, or as an interaction.</p>
<!-- **Add code** -->
<p>What if there is a correlation between the individuals? For instance, what if there were some ‘hidden variable’ that we didn’t know about, such as province, and it turned out that people from the same province were similar? In that case we could use ‘wider’ standard errors.</p>
<!-- **Add code** -->
<p>But a better way to deal with this may be to change the experiment. For instance, we discussed stratified sampling - perhaps we should stratify by province? How would we implement this?</p>
<!-- **Add code** -->
<p>Or we could try some of the methods that we will get to next.</p>
<!-- ## Next steps -->
<!-- Large scale experiments are happening all around us. These may be well-known such as: -->
<!-- - The RAND Health Insurance Experiment randomly gave health insurance to people in the US between 1974 and 1982.  -->
<!-- - The Oregon Health Study randomly gave health insurance in Oregon in 2008. -->
<!-- - **OTHERS** -->
<!-- They may be less-well-known, such as: -->
<!-- - Google example -->
<!-- - Amazon example -->
<!-- Or they may be trying to stay secret: -->
<!-- - **OTHERS** -->
<!-- But with increased data, there are also increased opportunities for us to examine them. Some ideas: -->
<!-- - There has recently been a TTC crack-down on fare evaders and there will soon be an increase in ticket prices. Can you think of how we could look at the effect of this? Is there a group who are not subject to the change? -->
<!-- -  -->
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="case-study-airbnb-listing-in-toronto.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="matching-difference-in-differences.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
